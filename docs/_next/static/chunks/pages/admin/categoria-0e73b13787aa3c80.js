(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[70],{6880:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/categoria",function(){return r(9758)}])},8044:function(e,t,r){"use strict";r.d(t,{Z:function(){return h}});var a=r(5893),n=r(1163),s=r(1664),i=r.n(s),o=r(7294);function c(e){let t={user:{email:""}},[r,n]=(0,o.useState)(t),s=()=>{localStorage.removeItem("usuario"),n(t)};return(0,o.useEffect)(()=>{console.log("recuperando usuario localStorage");let e=localStorage.getItem("usuario");e&&n(JSON.parse(e))},[]),(0,a.jsxs)("header",{style:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)("img",{id:"logo",src:"/desarrollo-frontend-banco/img/isotipo2.svg",alt:"logo"}),(0,a.jsxs)("section",{style:{display:"flex",alignItems:"center",gap:"1em",width:"16em"},children:[(0,a.jsxs)("span",{children:["Bienvenido ",r.user.email]}),(0,a.jsx)("img",{className:"user-profile",src:"/desarrollo-frontend-banco/img/user-profile.svg",alt:"usuario"}),(0,a.jsx)(i(),{href:"/admin/login",onClick:s,children:"Salir"})]})]})}let l=e=>{e?e.push("/admin/login"):window.location="/admin/login"},d=e=>{let t=localStorage.getItem("usuario");null==t&&l(e),JSON.parse(t)};function u(e){return(0,a.jsx)("aside",{children:(0,a.jsxs)("nav",{style:{display:"flex",flexDirection:"column",gap:"0.5em"},children:[(0,a.jsx)(i(),{href:"/admin",children:"Inicio"}),(0,a.jsx)(i(),{href:"/admin/consultas",children:"Consultas"}),(0,a.jsx)(i(),{href:"/admin/categoria",children:"Categor\xedas"}),(0,a.jsx)(i(),{href:"/admin/productos",children:"Productos"}),(0,a.jsx)(i(),{href:"/admin/configuracion",children:"Configuraci\xf3n"})]})})}function h(e){let{children:t}=e,r=(0,n.useRouter)(),[s,i]=(0,o.useState)("");return(0,o.useEffect)(()=>{d(r),i("cargado")},[]),(0,a.jsxs)("div",{id:"contenedor",className:s,children:[(0,a.jsx)(c,{}),(0,a.jsx)(u,{}),(0,a.jsx)("main",{style:{padding:"1em 2em"},children:t})]})}},3667:function(e,t){"use strict";t.Z={getBaseUrl:()=>"/desarrollo-frontend-banco",getWSBaseUrl:()=>["127.0.0.1","localhost"].includes(window.location.hostname)?"http://localhost:3000":"https://dapper-shorthaired-doom.glitch.me"}},9758:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var a=r(5893),n=r(7294),s=r(3667);function i(e){let{compMessage:t,setCompMessage:r,url:s,categorias:i,setCategorias:o}=e,[c,l]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),[h,x]=(0,n.useState)(""),[m,g]=(0,n.useState)(""),[f,j]=(0,n.useState)(""),p=async e=>{e.preventDefault();try{let e={nombre:d,descripcion:h},a="POST";"editar"==t.accion&&(a="PUT",e.id=t.data.id);let n=await fetch(s,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok)throw Error("No se pudo guardar la categor\xeda");let c=await n.json();if(console.dir(c),g("Categor\xeda '"+c.nombre+"' guardada con ID "+c.id),j("success"),"editar"==t.accion){let e=i.filter(e=>e.id!=t.data.id);o([...e,c])}else o([...i,c]),r({accion:"editar",data:c})}catch(e){console.error(e),g(e.message),j("error")}};return(0,n.useEffect)(()=>{t&&"nuevo"==t.accion?(l(""),u(""),x("")):t&&"editar"==t.accion&&(l(t.data.id),u(t.data.nombre),x(t.data.descripcion))},[t]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:f,children:m}),(0,a.jsxs)("form",{action:"index.html",method:"post",onSubmit:p,style:{gap:"1em",display:"grid",gridTemplateColumns:"1fr 3fr"},children:[(0,a.jsx)("label",{htmlFor:"nombre",children:"Nombre"}),(0,a.jsx)("input",{type:"text",id:"nombre",value:d,onChange:e=>u(e.target.value)}),(0,a.jsx)("label",{htmlFor:"descripcion",children:"Descripci\xf3n"}),(0,a.jsx)("textarea",{id:"descripcion",value:h,onChange:e=>x(e.target.value)}),(0,a.jsx)("div",{children:c.length>3?(0,a.jsx)("button",{type:"submit",children:"Editar"}):(0,a.jsx)("button",{type:"submit",children:"Crear"})})]})]})}function o(e){let{categorias:t,setCategorias:r,compMessage:s,setCompMessage:i,url:o}=e,[c,l]=(0,n.useState)(""),[d,u]=(0,n.useState)(""),h=async e=>{try{let a=await fetch(o+"?id="+e.id,{method:"DELETE"});await a.json(),l("Se borr\xf3 la categor\xeda: "+e.nombre),u("exito"),r(t.filter(t=>t.id!=e.id)),setTimeout(()=>{l(""),u("")},5e3)}catch(e){l("Hubo un error al borrar la categor\xeda: "+e.message),u("error")}},x=()=>{i({accion:"nuevo"})},m=e=>{i({accion:"editar",data:e})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:x,children:"Nuevo"}),(0,a.jsx)("p",{className:d,children:c}),(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"ID"}),(0,a.jsx)("th",{children:"Nombre"}),(0,a.jsx)("th",{children:"Descripci\xf3n"}),(0,a.jsx)("th",{children:"Acciones"})]})}),(0,a.jsxs)("tbody",{children:[0==t.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,children:"No hay categor\xedas que mostrar."})}),t.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.id}),(0,a.jsx)("td",{children:e.nombre}),(0,a.jsx)("td",{children:e.descripcion}),(0,a.jsxs)("td",{className:"botones",children:[(0,a.jsx)("button",{onClick:()=>m(e),children:"Editar"}),(0,a.jsx)("button",{onClick:()=>h(e),children:"Eliminar"})]})]},e.id))]})]})]})}function c(){let[e,t]=(0,n.useState)([]),[r,c]=(0,n.useState)({accion:"crear",data:{}}),l=s.Z.getWSBaseUrl(),d=l+"/categoria",u=async()=>{let e=await fetch(d);if(!e.ok)throw Error("Problema al traer las categor\xedas");let r=await e.json();t(r)};return(0,n.useEffect)(()=>{u()},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i,{url:d,compMessage:r,setCompMessage:c,categorias:e,setCategorias:t}),(0,a.jsx)("hr",{}),(0,a.jsx)(o,{url:d,categorias:e,setCategorias:t,compMessage:r,setCompMessage:c})]})}var l=r(8044);function d(){return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(l.Z,{children:(0,a.jsx)(c,{})})})}}},function(e){e.O(0,[424,774,888,179],function(){return e(e.s=6880)}),_N_E=e.O()}]);